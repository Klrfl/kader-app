---
import MainLayout from "@/layouts/MainLayout.astro";
import { newGroupRepo } from "@/repositories/groups";

const groups = await newGroupRepo().getVerboseGroups();
---

<MainLayout>
  <header class="py-4">
    <h1 class="text-2xl">Groups</h1>
  </header>

  <ul class="grid grid-cols-2 lg:grid-cols-3 gap-4">
    {
      groups.map((group) => (
        <li
          class:list={[
            "rounded border px-6 py-4",
            {
              "bg-red-700/30 border-red-700": group.percentage < 30,
            },
            {
              "bg-amber-700/30 border-amber-700": group.percentage > 30,
            },
            {
              "bg-green-700/30 border-green-700": group.percentage === 100,
            },
            {
              "border-base-content/30": group.percentage < 100,
            },
          ]}
        >
          <article>
            <h2 class="text-xl">
              <a class="link-hover" href={`/students/?group=${group.name}`}>
                {group.name}
              </a>
            </h2>
            (bonded with {group.bonded_count} out of {group.student_count},{" "}
            {group.percentage}% progress)
          </article>
        </li>
      ))
    }
  </ul>
</MainLayout>
